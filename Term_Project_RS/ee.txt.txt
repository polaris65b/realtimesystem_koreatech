https://github.com/farukulutas/CS342/blob/be4019f31188926357880ea90fa28d5ce3202bab/Projects/Project%202/mps.c#L92